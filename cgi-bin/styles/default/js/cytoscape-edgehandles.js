!function e(t,i){"object"==typeof exports&&"object"==typeof module?module.exports=i(require("lodash.memoize"),require("lodash.throttle")):"function"==typeof define&&define.amd?define(["lodash.memoize","lodash.throttle"],i):"object"==typeof exports?exports.cytoscapeEdgehandles=i(require("lodash.memoize"),require("lodash.throttle")):t.cytoscapeEdgehandles=i(t._.memoize,t._.throttle)}(this,function(e,t){return function(e){var t={};function i(s){if(t[s])return t[s].exports;var n=t[s]={i:s,l:!1,exports:{}};return e[s].call(n.exports,n,n.exports,i),n.l=!0,n.exports}return i.m=e,i.c=t,i.i=function(e){return e},i.d=function(e,t,s){i.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:s})},i.n=function(e){var t=e&&e.__esModule?function t(){return e.default}:function t(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=12)}([function(e,t,i){"use strict";e.exports=null!=Object.assign?Object.assign.bind(Object):function(e){for(var t=arguments.length,i=Array(t>1?t-1:0),s=1;s<t;s++)i[s-1]=arguments[s];return i.filter(function(e){return null!=e}).forEach(function(t){Object.keys(t).forEach(function(i){return e[i]=t[i]})}),e}},function(e,t,i){"use strict";var s=i(10),n=i(0);e.exports=function(e){return new s(n({cy:this},e))}},function(e,t,i){"use strict";e.exports={disableGestures:function e(){if(this.saveGestureState(),this.cy.zoomingEnabled(!1).panningEnabled(!1).boxSelectionEnabled(!1),this.options.disableBrowserGestures){var t=this.windowListenerOptions;window.addEventListener("touchstart",this.preventDefault,t),window.addEventListener("touchmove",this.preventDefault,t),window.addEventListener("wheel",this.preventDefault,t)}return this},resetGestures:function e(){if(this.cy.zoomingEnabled(this.lastZoomingEnabled).panningEnabled(this.lastPanningEnabled).boxSelectionEnabled(this.lastBoxSelectionEnabled),this.options.disableBrowserGestures){var t=this.windowListenerOptions;window.removeEventListener("touchstart",this.preventDefault,t),window.removeEventListener("touchmove",this.preventDefault,t),window.removeEventListener("wheel",this.preventDefault,t)}return this},saveGestureState:function e(){var t=this.cy;return this.lastPanningEnabled=t.panningEnabled(),this.lastZoomingEnabled=t.zoomingEnabled(),this.lastBoxSelectionEnabled=t.boxSelectionEnabled(),this}}},function(e,t,i){"use strict";e.exports={addCytoscapeListeners:function e(){var t=this,i=this.cy,s=this.options;return this.addListener(i,"drag",function(){return t.grabbingNode=!0}),this.addListener(i,"free",function(){return t.grabbingNode=!1}),this.addListener(i,"mouseover","node",function(e){t.show(e.target)}),this.addListener(i,"tap","node",function(e){var i=e.target;i.same(t.handleNode)||t.show(i)}),this.addListener(i,"position","node",function(e){e.target.same(t.sourceNode)&&t.hide()}),this.addListener(i,"tapstart","node",function(e){var i=e.target;i.same(t.handleNode)?t.start(t.sourceNode):t.drawMode?t.start(i):i.same(t.sourceNode)&&t.hide()}),this.addListener(i,"tapdrag",function(e){t.update(e.position)}),this.addListener(i,"tapdragover","node",function(e){s.snap||t.preview(e.target)}),this.addListener(i,"tapdragout","node",function(e){s.snap||t.unpreview(e.target)}),this.addListener(i,"tapend",function(){t.stop()}),this.addListener(i,"remove",function(e){e.target.same(t.sourceNode)&&t.hide()}),this}}},function(e,t,i){"use strict";e.exports={preview:!0,hoverDelay:150,handleNodes:"node",snap:!1,snapThreshold:50,snapFrequency:15,noEdgeEventsInDraw:!1,disableBrowserGestures:!0,handlePosition:function e(t){return"middle top"},handleInDrawMode:!1,edgeType:function e(t,i){return"flat"},loopAllowed:function e(t){return!1},nodeLoopOffset:-50,nodeParams:function e(t,i){return{}},edgeParams:function e(t,i,s){return{}},ghostEdgeParams:function e(){return{}},show:function e(t){},hide:function e(t){},start:function e(t){},complete:function e(t,i,s){},stop:function e(t){},cancel:function e(t,i){},hoverover:function e(t,i){},hoverout:function e(t,i){},previewon:function e(t,i,s){},previewoff:function e(t,i,s){},drawon:function e(){},drawoff:function e(){}}},function(e,t,i){"use strict";e.exports={toggleDrawMode:function e(t){var i=this.cy,s=this.options;return this.drawMode=null!=t?t:!this.drawMode,this.drawMode?(this.prevUngrabifyState=i.autoungrabify(),i.autoungrabify(!0),!s.handleInDrawMode&&this.handleShown()&&this.hide(),this.emit("drawon")):(i.autoungrabify(this.prevUngrabifyState),this.emit("drawoff")),this},enableDrawMode:function e(){return this.toggleDrawMode(!0)},disableDrawMode:function e(){return this.toggleDrawMode(!1)}}},function(e,t,i){"use strict";var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n=i(0);function o(e,t,i){var o,r,a={};return(n(a,t,e),n(a.data,t.data,e.data),(void 0===(r=t.classes)?"undefined":s(r))===s(""))?a.classes=t.classes+" "+i:(void 0===(o=t.classes)?"undefined":s(o))===s([])&&null!=o.length?a.classes=t.classes.join(" ")+" "+i:a.classes=i,a}e.exports={makeEdges:function e(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],i=this.cy,s=this.options,n=this.presumptiveTargets,r=this.previewEles,a=this.active,h=this.sourceNode,d=this.targetNode,u=t?"eh-preview":"",c=i.collection(),l=s.edgeType(h,d);if(a&&l&&(!t||s.preview)){if(!d||0===d.size()){r.remove(),this.emit("cancel",this.mp(),h,n);return}if(!t&&s.preview){r.removeClass("eh-preview").style("events",""),this.emit("complete",this.mp(),h,d,r);return}var p=h.position(),v=d.position(),f=void 0;if(f=h.same(d)?{x:p.x+s.nodeLoopOffset,y:p.y+s.nodeLoopOffset}:{x:(p.x+v.x)/2,y:(p.y+v.y)/2},"node"===l){var g=i.add(o({group:"nodes",position:f},s.nodeParams(h,d),u)),m=i.add(o({group:"edges",data:{source:h.id(),target:g.id()}},s.edgeParams(h,d,0),u)),y=i.add(o({group:"edges",data:{source:g.id(),target:d.id()}},s.edgeParams(h,d,1),u));c=c.merge(g).merge(m).merge(y)}else{var w=i.add(o({group:"edges",data:{source:h.id(),target:d.id()}},s.edgeParams(h,d,0),u));c=c.merge(w)}return t?(this.previewEles=c,c.style("events","no")):(c.style("events",""),this.emit("complete",this.mp(),h,d,c)),this}},makePreview:function e(){return this.makeEdges(!0),this},removePreview:function e(){return this.previewShown()&&this.previewEles.remove(),this},previewShown:function e(){return this.previewEles.nonempty()&&this.previewEles.inside()},updateEdge:function e(){var t=this,i=this.sourceNode,s=this.ghostNode,o=this.cy,r=this.mx,a=this.my,h=this.options,d=void 0,u=void 0;if(i)return(!s||0===s.length||s.removed())&&(u=this.ghostEles=o.collection(),o.batch(function(){(s=t.ghostNode=o.add({group:"nodes",classes:"eh-ghost eh-ghost-node",position:{x:0,y:0}})).style({"background-color":"blue",width:1e-4,height:1e-4,opacity:0,events:"no"});var e=h.ghostEdgeParams();(d=o.add(n({},e,{group:"edges",data:n({},e.data,{source:i.id(),target:s.id()}),classes:"eh-ghost eh-ghost-edge"}))).style({events:"no"})}),u.merge(s).merge(d)),s.position({x:r,y:a}),this},handleShown:function e(){return this.handleNode.nonempty()&&this.handleNode.inside()},setHandleFor:function e(t){var i=this,n=this.options,o=this.cy,r=s(n.handlePosition)===s("")?function(){return n.handlePosition}:n.handlePosition,a=t.position(),h=t.outerHeight(),d=t.outerWidth(),u=0,c=0,l=r(t).toLowerCase().split(/\s+/),p=l[0],v=l[1];"left"===p?u=-(d/2):"right"===p&&(u=d/2),"top"===v?c=-(h/2):"bottom"===v&&(c=h/2);var f,g={x:this.hx=a.x+u,y:this.hy=a.y+c};return this.handleShown()?this.handleNode.position(g):o.batch(function(){i.handleNode=o.add({classes:"eh-handle",position:g,grabbable:!1,selectable:!1}),i.handleNode.style("z-index",9007199254740991)}),this},removeHandle:function e(){return this.handleShown()&&this.handleNode.remove(),this}}},function(e,t,i){"use strict";e.exports={disableEdgeEvents:function e(){return this.options.noEdgeEventsInDraw&&this.cy.edges().style("events","no"),this},enableEdgeEvents:function e(){return this.options.noEdgeEventsInDraw&&this.cy.edges().style("events",""),this}}},function(e,t,i){"use strict";e.exports={enable:function e(){return this.enabled=!0,this.emit("enable"),this},disable:function e(){return this.enabled=!1,this.emit("disable"),this}}},function(e,t,i){"use strict";i(13);var s=Math.sqrt(2);e.exports={show:function e(t){var i=this.options,s=this.drawMode;if(this.canStartOn(t)&&(!s||i.handleInDrawMode))return this.sourceNode=t,this.setHandleFor(t),this.emit("show",this.hp(),this.sourceNode),this},hide:function e(){return this.removeHandle(),this.emit("hide",this.hp(),this.sourceNode),this},start:function e(t){this.canStartOn(t)&&(this.active=!0,this.sourceNode=t,this.sourceNode.addClass("eh-source"),this.disableGestures(),this.disableEdgeEvents(),this.emit("start",this.hp(),t))},update:function e(t){if(this.active){var i=t;return this.mx=i.x,this.my=i.y,this.updateEdge(),this.throttledSnap(),this}},preview:function e(t){var i=this,s=!(arguments.length>1)||void 0===arguments[1]||arguments[1],n=this.options,o=this.sourceNode,r=this.ghostNode,a=this.ghostEles,h=this.presumptiveTargets,d=this.previewEles,u=this.active,c=o,l=t.same(c),p=n.loopAllowed(t),v=t.same(r),f=!n.edgeType(c,t),g=t.same(this.handleNode),m=t.same(this.targetNode);if(!u||g||v||f||m||l&&!p)return!1;this.targetNode.nonempty()&&this.unpreview(this.targetNode),clearTimeout(this.previewTimeout);var y=function e(){i.targetNode=t,h.merge(t),t.addClass("eh-presumptive-target"),t.addClass("eh-target"),i.emit("hoverover",i.mp(),c,t),n.preview&&(t.addClass("eh-preview"),a.addClass("eh-preview-active"),o.addClass("eh-preview-active"),t.addClass("eh-preview-active"),i.makePreview(),i.emit("previewon",i.mp(),c,t,d))};return s&&n.hoverDelay>0?this.previewTimeout=setTimeout(y,n.hoverDelay):y(),!0},unpreview:function e(t){if(!(!this.active||t.same(this.handleNode))){var i=this.previewTimeout,s=this.sourceNode,n=this.previewEles,o=this.ghostEles,r=this.cy;clearTimeout(i),this.previewTimeout=null;var a=s;return t.removeClass("eh-preview eh-target eh-presumptive-target eh-preview-active"),o.removeClass("eh-preview-active"),s.removeClass("eh-preview-active"),this.targetNode=r.collection(),this.removePreview(a,t),this.emit("hoverout",this.mp(),a,t),this.emit("previewoff",this.mp(),a,t,n),this}},stop:function e(){if(this.active){var t=this.sourceNode,i=this.targetNode,s=this.ghostEles,n=this.presumptiveTargets;return clearTimeout(this.previewTimeout),t.removeClass("eh-source"),i.removeClass("eh-target eh-preview eh-hover"),n.removeClass("eh-presumptive-target"),this.makeEdges(),this.removeHandle(),s.remove(),this.clearCollections(),this.resetGestures(),this.enableEdgeEvents(),this.active=!1,this.emit("stop",this.mp(),t),this}},snap:function e(){if(!this.active||!this.options.snap)return!1;var t=this.cy,i=this.targetNode,n=this.options.snapThreshold,o=this.mp(),r=this.handleNode,a=this.previewEles,h=this.ghostNode,d=function e(t,i,s,n){var o=s-t,r=n-i;return o*o+r*r},u=function e(t){var i,s;return i=t.position(),s=o,d(i.x,i.y,s.x,s.y)},c=function e(t){var i,o=s*Math.max((i=t).outerWidth(),i.outerHeight())/2+n;return o*o},l=function e(t){return u(t)<=c(t)},p=function e(t){var i=t.position(),s=t.outerWidth()/2,n=t.outerHeight()/2,r=i.x,a=i.y,h=o.x,u=o.y,c=r-s,l=r+s,p=a-n,v=a+n,f=c<=h&&h<=l,g=p<=u&&u<=v;if(f&&g)return 0;if(f){var m=u-p,y=u-v;return Math.min(m*m,y*y)}if(g){var w=h-c,b=h-l;return Math.min(w*w,b*b)}if(h<c&&u<p)return d(h,u,c,p);if(h>l&&u<p)return d(h,u,l,p);else if(h<c&&u>v)return d(h,u,c,v);else return d(h,u,l,v)},v=function e(t,i){return p(t)-p(i)},f=function e(t){var i=o,s=t.outerWidth()/2,n=t.outerHeight()/2,r=t.position(),a=r.x-s,h=r.x+s,d=r.y-n,u=r.y+n;return a<=i.x&&i.x<=h&&d<=i.y&&i.y<=u},g=t.nodes(function(e){var t;return!((t=e).same(r)||t.same(a)||t.same(h))&&l(e)}).sort(v),m=!1;i.nonempty()&&!l(i)&&this.unpreview(i);for(var y=0;y<g.length;y++){var w=g[y];if(!(w.isParent()&&f(w)||w.isChild()&&!f(w.parent()))&&(w.same(i)||this.preview(w,!1))){m=!0;break}}return m},canStartOn:function e(t){var i,s,n,o,r,a=this.options,h=this.previewEles,d=this.ghostEles,u=this.handleNode,c=this.enabled,l=this.active,p=this.grabbingNode;return c&&!l&&!p&&(null==t||(s=i=t,!(h.anySame(s)||(n=i,u.same(n))||(o=i,d.anySame(o)))&&(r=t).filter(a.handleNodes).length>0))},canStartDrawModeOn:function e(t){return this.canStartOn(t)&&this.drawMode},canStartNonDrawModeOn:function e(t){return this.canStartOn(t)&&!this.drawMode}}},function(e,t,i){"use strict";var s=i(4),n=i(0),o=i(14),r=i(2),a=i(3),h=i(5),d=i(6),u=i(8),c=i(9),l=i(11),p=i(7);function v(e){var t=e.cy;this.cy=t,this.listeners=[],this.enabled=!0,this.drawMode=!1,this.active=!1,this.grabbingNode=!1,this.handleNode=t.collection(),this.clearCollections(),this.hx=0,this.hy=0,this.hr=0,this.mx=0,this.my=0,this.options=n({},s,e),this.saveGestureState(),this.addListeners(),this.throttledSnap=o(this.snap.bind(this),1e3/e.snapFrequency),this.preventDefault=function(e){return e.preventDefault()};var i=!1;try{var r=Object.defineProperty({},"passive",{get:function e(){i=!0}});window.addEventListener("test",null,r)}catch(a){}i?this.windowListenerOptions={capture:!0,passive:!1}:this.windowListenerOptions=!0}var f=v.prototype={},g=function e(t){return n(f,t)};f.destroy=function(){this.removeListeners()},f.setOptions=function(e){n(this.options,e)},f.mp=function(){return{x:this.mx,y:this.my}},f.hp=function(){return{x:this.hx,y:this.hy}},f.clearCollections=function(){var e=this.cy;this.previewEles=e.collection(),this.ghostEles=e.collection(),this.ghostNode=e.collection(),this.sourceNode=e.collection(),this.targetNode=e.collection(),this.presumptiveTargets=e.collection()},[r,a,h,d,u,c,l,p].forEach(g),e.exports=v},function(e,t,i){"use strict";var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function n(e,t,i,n,o){return(void 0===i?"undefined":s(i))!==s("")&&(o=n=i,i=null),null==o&&(o=!1),{target:e,event:t,selector:i,callback:n,options:o}}function o(e){return e instanceof Element}e.exports={addListener:function e(t,i,s,r,a){var h=n(t,i,s,r,a);return this.listeners.push(h),o(h.target)?h.target.addEventListener(h.event,h.callback,h.options):h.selector?h.target.addListener(h.event,h.selector,h.callback,h.options):h.target.addListener(h.event,h.callback,h.options),this},addListeners:function e(){var t=this;return this.addCytoscapeListeners(),this.addListener(this.cy,"destroy",function(){return t.destroy()}),this},removeListener:function e(t,i,s,r,a){for(var h=n(t,i,s,r,a),d=this.listeners.length-1;d>=0;d--){var u=this.listeners[d];if(h.target===u.target&&h.event===u.event&&(null==h.selector||h.selector===u.selector)&&(null==h.callback||h.callback===u.callback)){this.listeners.splice(d,1),o(h.target)?h.target.removeEventListener(h.event,h.callback,h.options):h.selector?h.target.removeListener(h.event,h.selector,h.callback,h.options):h.target.removeListener(h.event,h.callback,h.options);break}}return this},removeListeners:function e(){for(var t=this.listeners.length-1;t>=0;t--){var i=this.listeners[t];this.removeListener(i.target,i.event,i.selector,i.callback,i.options)}return this},emit:function e(t,i){for(var s=this.options,n=this.cy,o=arguments.length,r=Array(o>2?o-2:0),a=2;a<o;a++)r[a-2]=arguments[a];n.emit({type:"eh"+t,position:i},r);var h=s[t];return null!=h&&h.apply(void 0,r),this}}},function(e,t,i){"use strict";var s=i(1),n=function e(t){t&&t("core","edgehandles",s)};"undefined"!=typeof cytoscape&&n(cytoscape),e.exports=n},function(t,i){t.exports=e},function(e,i){e.exports=t}])});